<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:t="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AdminLTE 2 | Starter</title>
    <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
    <!--<meta name="_csrf" th:content="${_csrf.token}">
    <meta name="_csrf_header" th:content="${_csrf.headerName}">-->
    <!-- Bootstrap 3.3.7 -->
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/3.3.7/css/bootstrap.min.css}">
    <!-- Font Awesome -->
    <link th:href="@{/webjars/font-awesome/4.7.0/css/font-awesome.min.css}" rel="stylesheet">
    <!-- Ionicons -->
    <link th:href="@{/webjars/ionicons/2.0.1/css/ionicons.min.css}" rel="stylesheet">
    <!-- Select2 -->
    <link rel="stylesheet" th:href="@{/webjars/select2/4.0.5/css/select2.min.css}">
    <!-- Theme style -->
    <link rel="stylesheet" th:href="@{/webjars/AdminLTE/2.4.2/dist/css/AdminLTE.min.css}">
    <!-- AdminLTE Skins. Choose a skin from the css/skins folder instead of downloading all of them to reduce the load. -->
    <link rel="stylesheet" th:href="@{/webjars/bootstrap-table/1.12.1/dist/bootstrap-table.min.css}">
    <link rel="stylesheet" th:href="@{/webjars/jquery-treegrid/0.3.0/css/jquery.treegrid.css}">
    <!-- toastr 2.1.3 -->
    <link rel="stylesheet" th:href="@{/webjars/toastr/2.1.3/toastr.min.css}">
    <link rel="stylesheet" th:href="@{/webjars/bootstrap-sweetalert/1.0.1/dist/sweetalert.css}">
    <!--[if lt IE 9]>
    <script src="/webjars/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
    <script src="/webjars/respond/1.4.2/dest/respond.min.js"></script>
    <![endif]-->
    <!-- Include external CSS. -->
    <!--<link href="https://cdn.bootcss.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">-->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.25.0/codemirror.min.css" rel="stylesheet">

    <!-- Include Editor style. -->
    <link rel="stylesheet" th:href="@{/webjars/froala_editor/2.8.5/css/froala_editor.pkgd.min.css}">
    <link rel="stylesheet" th:href="@{/webjars/froala_editor/2.8.5/css/froala_style.min.css}">

    <!-- CSS rules for styling the element inside the editor such as p, h1, h2, etc. -->
    <link rel="stylesheet" th:href="@{/webjars/froala_editor/2.8.5/css/froala_style.min.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
</head>
<body>
<div>
    <form>
        <div class="form-group">
            <!--<label for="content">正文</label>
            <input type="text" class="form-control" id="content" name="content" placeholder="正文">-->
            <label for="content">新闻详情</label>
            <!-- Create a tag that we will use as the editable area. -->
            <!-- You can use a div tag as well. -->
            <textarea id="content" name="content"></textarea>
            <!--<input type="hidden" id="content" name="content" placeholder="正文">-->
        </div>
    </form>
</div>
<!-- ./wrapper -->
<!-- jQuery 3 -->
<script th:src="@{/webjars/jquery/3.3.1/dist/jquery.min.js}"></script>
<!-- Bootstrap 3.3.7 -->
<script th:src="@{/webjars/bootstrap/3.3.7/js/bootstrap.min.js}"></script>
<!-- AdminLTE App -->
<script th:src="@{/webjars/AdminLTE/2.4.2/dist/js/adminlte.min.js}"></script>
<!-- Select2 -->
<script th:src="@{/webjars/select2/4.0.5/js/select2.full.min.js}"></script>
<script th:src="@{/webjars/bootstrap-sweetalert/1.0.1/dist/sweetalert.min.js}"></script>
<!--<script th:src="@{/webjars/sweetalert2/7.26.29/dist/sweetalert2.all.min.js}"></script>-->
<!-- Bootstrap Table 1.12.1 -->
<script th:src="@{/webjars/bootstrap-table/1.12.1/dist/bootstrap-table.min.js}"></script>
<script th:src="@{/webjars/bootstrap-table/1.12.1/dist/locale/bootstrap-table-zh-CN.min.js}"></script>
<script th:src="@{/webjars/bootstrap-table/1.12.1/dist/extensions/treegrid/bootstrap-table-treegrid.min.js}"></script>
<script th:src="@{/webjars/bootstrap-table/1.12.1/dist/extensions/resizable/bootstrap-table-resizable.js}"></script>

<!-- jquery treegrid 0.3.0 -->
<script th:src="@{/plug-in/colResizable.jquery.plugin/colResizable-1.5.source.js}"></script>
<script th:src="@{/webjars/jquery-treegrid/0.3.0/js/jquery.treegrid.min.js}"></script>
<script th:src="@{/webjars/jquery-treegrid/0.3.0/js/jquery.treegrid.bootstrap3.js}"></script>

<!-- tableExport -->
<script th:src="@{/webjars/bootstrap-table/1.12.1/dist/extensions/export/bootstrap-table-export.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/FileSaver/FileSaver.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/js-xlsx/xlsx.core.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/jsPDF/jspdf.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/jsPDF-AutoTable/jspdf.plugin.autotable.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/pdfmake/pdfmake.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/pdfmake/vfs_fonts.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/libs/html2canvas/html2canvas.min.js}"></script>
<script th:src="@{/plug-in/tableExport.jquery.plugin/tableExport.js}"></script>

<!-- Include external JS libs. -->
<script th:src="@{/webjars/codemirror/5.40.2/lib/codemirror.js}"></script>
<script th:src="@{/webjars/codemirror/5.40.2/mode/xml/xml.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/froala_editor.pkgd.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/languages/zh_cn.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/code_view.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/code_beautifier.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/file.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/image.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/draggable.min.js}"></script>
<script th:src="@{/webjars/froala_editor/2.8.5/js/plugins/video.min.js}"></script>

<script th:src="@{/webjars/jquery-cookie/1.4.1-1/jquery.cookie.js}"></script>

<!-- toastr 2.1.3 -->
<script th:src="@{/webjars/toastr/2.1.3/toastr.min.js}"></script>

<script th:src="@{/js/util.js}"></script>
<script th:src="@{/js/table.js}"></script>
<script th:src="@{/js/common.js}"></script>
<!-- Initialize the editor. -->
<script>
    $(function () {
        //必须加这段代码，不然无法上传
        /*var token = $("meta[name='_csrf']").attr("content");
        var header = $("meta[name='_csrf_header']").attr("content");
        //console.log(header);
        $(document).ajaxSend(function (e, xhr, options) {
            xhr.setRequestHeader(header, token);
        });*/

        function initTextarea(){
            $('textarea').froalaEditor('html.set', '<p>My custom paragraph.</p>');
        }

        initEditor();

        function initEditor() {
            $('textarea').froalaEditor({
                width: '100%',
                language: 'zh_cn',
                height: 300,
                heightMax: 500,
                heightMin: 200,
                fileUploadParam: 'file',
                fileUploadURL: '/fileUploads/uploadFile',
                fileUploadParams: {},
                fileUploadMethod: 'POST',
                fileMaxSize: 20 * 1024 * 1024,
                fileAllowedTypes: ['*'],
                imageAllowedTypes: ['jpeg', 'jpg', 'png'],
                imageDefaultWidth: 600,
                imageMaxSize: 1024 * 1024 * 10,
                imageMinWidth: 600,
                imageUploadParam: 'file',
                imageUploadParams:{},
                imageUploadRemoteUrls: false,
                imageUploadURL: '/fileUploads/uploadFile',
                videoAllowedTypes: ['mp4', 'webm', 'ogg'],
                videoDefaultAlign: true,
                videoDefaultDisplay: 'block',
                videoDefaultWidth: 600,
                videoEditButtons: ['videoReplace', 'videoRemove', '|', 'videoDisplay', 'videoAlign', 'videoSize'],
                videoInsertButtons: ['videoBack', '|', 'videoByURL', 'videoEmbed', 'videoUpload'],
                videoMaxSize: 1024 * 1024 * 100,
                videoMove: true,
                videoResize: true,
                videoSizeButtons: ['videoBack', '|'],
                videoSplitHTML: false,
                videoTextNear: true,
                videoUpload: true,
                videoUploadMethod: 'POST',
                videoUploadParam: 'file',
                videoUploadParams: {},
                videoUploadURL: '/fileUploads/uploadFile'
                /*requestHeaders: {
                    'X-CSRF-TOKEN':token
                }*/
            });

            $('textarea').on('froalaEditor.contentChanged', function (e, editor) {
                console.log($(this).froalaEditor('html.get', true));
                $('input[name="content"]').val($(this).froalaEditor('html.get', true));
            });

            $('textarea').on('froalaEditor.file.uploaded', function (e, editor, response) {
                console.log("uploaded=" + response);
            }).on('froalaEditor.file.error', function (e, editor, error, response) {
                console.log("error=" + JSON.stringify(error));
                console.log("response" + response);
                // Bad link.
                if (error.code == 1) {
                    console.log("bad link");
                }

                // No link in upload response.
                else if (error.code == 2) {
                    console.log("No link in upload response.");
                }

                // Error during file upload.
                else if (error.code == 3) {
                    console.log("Error during file upload.");
                }

                // Parsing response failed.
                else if (error.code == 4) {
                    console.log("Parsing response failed.");
                }

                // File too text-large.
                else if (error.code == 5) {
                    console.log("File too text-large.");
                }

                // Invalid file type.
                else if (error.code == 6) {
                    console.log("Invalid file type.");
                }

                // File can be uploaded only to same domain in IE 8 and IE 9.
                else if (error.code == 7) {
                    console.log("File can be uploaded only to same domain in IE 8 and IE 9.");
                }

                // Response contains the original server response to the request if available.
            });

            $('textarea').on('froalaEditor.image.uploaded', function (e, editor, response) {
                console.log("uploaded=" + response);
                var json = jQuery.parseJSON(response);
                var img_URL = '/fileUploads/file/' + json.data[0];
                editor.image.insert(img_URL, false, null, editor.image.get(), null);
                return false;
            });

            $('textarea').off('froalaEditor.contentChanged');
            $('textarea').off('froalaEditor.image.uploaded');
            $('textarea').off('froalaEditor.file.uploaded');
        }
    });
</script>
</body>
</html>